<!doctype html>
<html>
<head>
	<meta charset="UTF-8">
	<title></title>
	<meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no" />
	<link rel="stylesheet" href="../css/mui.min.css" />
	<link rel="stylesheet" href="../css/app.css" />
  <style type="text/css">
    .mui-content-padded {
      padding: 50px 0 0;
    }
    .mui-table-view-chevron .mui-table-view-cell {
      padding-right: 40px;
    }
    .mui-table-view-chevron .mui-table-view-cell>a:not(.mui-btn) {
      margin-right: -40px;
    }
    em {
      font-style: normal;
    }
  </style>
</head>

<body>
	<header class="mui-bar mui-bar-nav">
		<a class="mui-action-back mui-icon mui-icon-left-nav mui-pull-left"><span class="font14">返回</span></a>
		<h1 class="mui-title" id="title">店铺详情</h1>
	</header>
	<div id="myapp" class="mui-content" v-cloak>
    <div class="mui-card mui-padding">
    	<div class="mui-input-row deMargin">
    		<label>营业状态</label>
    		<div class="mui-switch mui-switch-blue" id="switch" :class="storeData.opening_status == '1'?'':'mui-active'">
    			<span class="mui-text-right">营业</span>
    			<span class="mui-text-left">休息</span>
    			<div class="mui-switch-handle"></div>
    		</div>
    	</div>
    </div>
    <div class="mui-card">
			<form class="mui-input-group no-border-before no-border-after">
				<ul class="mui-table-view mui-table-view-chevron color666">
          <li class="mui-table-view-cell">
          	<a data-href="store-base.html" id="store-base" class="mui-navigate-right">
          		<span class="margin-right-5 color999">店铺信息</span>
              <em class="mui-pull-right">{{storeData.name}}</em>
          	</a>
          </li>
					<li class="mui-table-view-cell">
						<a data-href="address.html" id="address" class="mui-navigate-right">
							<span class="margin-right-5 color999">店铺地址</span>
              <em class="mui-pull-right">{{storeData.address}}</em>
						</a>
					</li>
				</ul>
      </form>
    </div>
    <div class="mui-card">
      <form class="mui-input-group no-border-before no-border-after">
				<ul class="mui-table-view mui-table-view-chevron color666 store">
					<li class="mui-table-view-cell">
						<a data-href="store-bank.html" id="store-bank" class="mui-navigate-right color333">
							<span>账户信息</span>
						</a>
					</li>
          <li class="mui-table-view-cell">
          	<a data-href="service-time.html" id="service-time" class="mui-navigate-right color333">
          		<span>营业时间</span>
          	</a>
          </li>
          <li class="mui-table-view-cell">
          	<a data-href="busy-time.html" id="busy-time" class="mui-navigate-right color333">
          		<span>忙碌时段</span>
          	</a>
          </li>
					<li class="mui-table-view-cell">
						<a data-href="bill-scope.html" id="bill-scope" class="mui-navigate-right">
							<span>营业范围</span>
						</a>
					</li>
				</ul>
			</form>
    </div>
    <div class="mui-card">
      <form class="mui-input-group no-border-before no-border-after">
      	<ul class="mui-table-view mui-table-view-chevron color666 store">
      		<li class="mui-table-view-cell">
      			<a data-href="authentication.html" id="authentication" class="mui-navigate-right color333">
      				<span>我的认证</span>
              <em class="mui-pull-right" :class="storeData.certification_status == 2 ? 'green' : 'red'">{{storeData.certification_status_text}}</em>
      			</a>
      		</li>
      	</ul>
      </form>
		</div>
	</div>
<script type="text/javascript" src="../js/mui.min.js"></script>
<script type="text/javascript" src="../js/vue.min.js" ></script>
<script type="text/javascript" src="../js/jquery-3.3.1.min.js" ></script>
<script type="text/javascript" src="../js/app.js" ></script>
<script type="text/javascript" src="../js/uploader.js"></script>
<script type="text/javascript">
	mui.init();
	document.addEventListener('get_detail', function(event) {
		vm.storeData = event.detail.storeData;
	});
  vm = new Vue({
    el: '#myapp',
    data: {
      storeData: "",
      imageData: [],
      authentication: ""
    }
  })
	mui.plusReady(function (){
	doAjax("/company/store/info",{_token: UserInfo.data._token},function(_data) {
		// console.log(JSON.stringify(_data));
		vm.storeData = _data;
	})
  doAjax("/company/store/getCertification",{_token: UserInfo.data._token},function(_data) {
  	// console.log(JSON.stringify(_data));
  	vm.authentication = _data;
  })
	mui(".mui-table-view").on("tap","a",function () {
		var pageUrl = $(this).data("href");
		var pageId = $(this).attr("id");
		if(pageId) {
      if(pageId == "authentication" && vm.storeData.certification_status != 2) {
        if(vm.storeData.certification_type == 2) {
          pageUrl = "individual-store.html";
          pageId = "individual-store";
        } else if(vm.storeData.certification_type == 3) {
          pageUrl = "enterprise-store.html";
          pageId = "enterprise-store";
        } else if(vm.storeData.certification_type == 1) {
          pageUrl = "personal-store.html";
          pageId = "personal-store";
        }
      }
			openWindow(pageUrl,pageId,{data: vm.storeData,authenticationData: vm.authentication},false)
		}
	})
	$("#switch").on('tap', function(event) {
		doAjax("/company/store/updateOpening",{_token: UserInfo.data._token},function(_data,_msg) {
			mui.toast(_msg);
			if(vm.storeData.opening_status == "1") {
				vm.storeData.opening_status = "2";
			} else {
				vm.storeData.opening_status = "1";
			}
		})
	});
})
</script>
</body>

</html>