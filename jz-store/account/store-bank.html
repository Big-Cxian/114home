<!doctype html>
<html>
<head>
	<meta charset="UTF-8">
	<title></title>
	<meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no" />
	<link rel="stylesheet" href="../css/mui.min.css" />
	<link rel="stylesheet" href="../css/app.css" />
  <style type="text/css">
    .mui-input-row select {
      font-size: 14px;
      color: #333;
    }
  </style>
</head>

<body>
	<header class="mui-bar mui-bar-nav">
		<a class="mui-action-back mui-icon mui-icon-left-nav mui-pull-left"><span class="font14">返回</span></a>
		<h1 class="mui-title">结算账户</h1>
	</header>
	<div id="myapp" class="mui-content" v-cloak>
    <div class="mui-card">
      <form class="mui-input-group no-border-before no-border-after">
        <div class="mui-input-row height-auto">
        	<label>选择银行</label>
          <select name="public-choice" v-model="bankInfo.bank">                                        
              <option :value="coupon.bank" v-for="coupon in bankList" >{{coupon.bank}}</option>                                    
          </select>
        </div>
        <div class="mui-input-row">
          <label>开户银行</label>
          <input type="text" v-model="bankInfo.bank_name" placeholder="开户银行" >
        </div>
        <div class="mui-input-row">
          <label>银行卡号</label>
          <input type="number" v-model="bankInfo.bank_card"  placeholder="银行卡号" >
        </div>
        <div class="mui-input-row">
          <label>持卡人</label>
          <input type="text" v-model="bankInfo.account_name" placeholder="持卡人" >
        </div>
        <div class="mui-input-row">
          <label>预留手机</label>
          <input type="number" v-model="bankInfo.reserve_mobile" placeholder="预留手机" >
        </div>
      </form>
    </div>
    <p class="padding-left-right font12">*请核对银行信息无误，以免影响结算</p>
    <div class="mui-content-padded button-fix">
    	<button type="button" class="mui-btn mui-btn-royal mui-btn-block buttom-button" id="save">
    		<i class="mui-icon mui-icon-checkmarkempty"></i>
    			提交
    	</button>
    </div>
	</div>
<script type="text/javascript" src="../js/mui.min.js"></script>
<script type="text/javascript" src="../js/vue.min.js"></script>
<script type="text/javascript" src="../js/jquery-3.3.1.min.js" ></script>
<script type="text/javascript" src="../js/app.js" ></script>
<script type="text/javascript">
	mui.init();
  var vm = new Vue({
  	el: '#myapp',
  	data: {
      storeData: "",
      bankInfo: "",
      bankList: [],
      bankSelectedId: ""
  	}
  })
	mui.plusReady(function (){
    var heard = plus.webview.currentWebview();
    vm.storeData = heard.storeData;
    doAjax("/company/store/getBank","",function(_data) {
      // console.log(JSON.stringify(_data));
      vm.bankInfo = _data;
      // getBankSelectedId();
    },"get")
    doAjax("/company/bank/list","",function(_data) {
      // console.log(JSON.stringify(_data));
      vm.bankList = _data.list;
      // getBankSelectedId()
    },"get")
    function getBankSelectedId() {
      for(var i in vm.bankList) {
        if(vm.bankList[i].bank == vm.bankInfo.bank) {
          vm.bankSelectedId = vm.bankList[i].id;
        }
      }
    }
    $("#save").on("tap",function(){
      console.log(JSON.stringify({
          bank: vm.bankInfo.bank, //银行名称 选择
          bank_name: vm.bankInfo.bank_name,//开户行名称
          bank_card: vm.bankInfo.bank_card,//银行卡号
          account_name: vm.bankInfo.account_name,
          reserve_mobile: vm.bankInfo.reserve_mobile
        }));
      doAjax("/company/store/editStore",{
        _token: UserInfo.data._token,
        type: 2,
        param: JSON.stringify({
          bank: vm.bankInfo.bank, //银行名称 选择
          bank_name: vm.bankInfo.bank_name,//开户行名称
          bank_card: vm.bankInfo.bank_card,//银行卡号
          account_name: vm.bankInfo.account_name,
          reserve_mobile: vm.bankInfo.reserve_mobile
        })
      },function(_data,_msg) {
        console.log(JSON.stringify(_data));
        mui.fire(plus.webview.getWebviewById("store"), 'get_detail', {
          storeData: vm.storeData
        });
        mui.toast(_msg);
        mui.back();
      })
    })
  })
</script>
</body>

</html>