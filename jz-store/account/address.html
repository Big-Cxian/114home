<!doctype html>
<html>
<head>
	<meta charset="UTF-8">
	<title></title>
	<meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no" />
	<link rel="stylesheet" href="../css/mui.min.css" />
	<link rel="stylesheet" href="../css/mui.picker.min.css" />
	<link rel="stylesheet" href="../css/mui.poppicker.css" />
	<link rel="stylesheet" href="../css/app.css" />
  <style type="text/css">
    textarea {
      margin: 7px 15px 7px 0 !important;
      padding: 0;
      font-size: 14px;
      color: #333;
      background-color: #FBFBFB !important;
    }
    .mui-input-row label~textarea {
      width: calc(100% - 120px);
    }
    .mui-input-row select {
      font-size: 14px;
      color: #333;
    }
  </style>
</head>

<body>
	<header class="mui-bar mui-bar-nav">
		<a class="mui-action-back mui-icon mui-icon-left-nav mui-pull-left"><span class="font14">返回</span></a>
		<h1 class="mui-title">店铺地址</h1>
	</header>
	<div id="myapp" class="mui-content" v-cloak>
		<div class="mui-card">
			<form class="mui-input-group no-border-before no-border-after">
				<div class="mui-input-row height-auto">
					<label>所在地区</label>
          <select name="public-choice" v-model="citySelected">                                        
              <option :value="coupon.city_id" v-for="coupon in cityList" >{{coupon.area_text}}</option>                                    
          </select>
				</div>
				<div class="mui-input-row height-auto">
					<label>详细地址</label>
					<textarea rows="4" class="font14 color333" type="text" v-model="storeData.address" placeholder="店铺详细地址" ></textarea>
				</div>
			</form>
		</div>
		<p class="margin10 font12">*请务必填写真实地址，系统会根据您的实际地址进行推广，地址将在店铺详情页面展示，便于买家了解您当前所在地</p>
		<div class="mui-content-padded button-fix">
			<button type="button" class="mui-btn mui-btn-warning mui-btn-block buttom-button" id="save">
				<i class="mui-icon mui-icon-checkmarkempty"></i>
					提交修改
			</button>
		</div>
	</div>
<script type="text/javascript" src="../js/mui.min.js"></script>
<script type="text/javascript" src="../js/vue.min.js" ></script>
<script type="text/javascript" src="../js/jquery-3.3.1.min.js" ></script>
<script type="text/javascript" src="../js/app.js" ></script>
<script type="text/javascript">
	mui.init();
  var vm = new Vue({
  	el: '#myapp',
  	data: {
  		storeData: "",
      cityList:[],
      citySelected: ""
  	}
  })
	mui.plusReady(function (){
		var heard = plus.webview.currentWebview();
    vm.storeData = heard.data;
    vm.citySelected = heard.data.city_id;
    // console.log(JSON.stringify(vm.storeData));
		doAjax("company/city/list","",function(_data) {
      // console.log(JSON.stringify(_data));
      vm.cityList = _data.list;
      vm.citySelected = vm.storeData.city_id || _data.list[0].city_id;
		},"get")
		$("#save").on("tap",function (){
			if(vm.storeData.address == "") {
				mui.toast("请输入详细地址");
				return;
			}
			doAjax("/company/store/updateAddr",{
				_token: UserInfo.data._token,
				city_id: vm.citySelected,
				address: vm.storeData.address
			},function(_data,_msg) {
        // console.log(JSON.stringify(_data));
        vm.storeData.city_id = vm.citySelected;
        mui.fire(plus.webview.getWebviewById("store"), 'get_detail', {
          storeData: vm.storeData
        });
				mui.toast(_msg);
				mui.back();
			})
		})
	})
</script>
</body>

</html>